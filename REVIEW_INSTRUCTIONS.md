# ⚠️ REVIEW INSTRUCTIONS

> Generated by Gemini

```toml
[review]
summary = "The security improvements regarding access control and script execution context are well-designed and address the major risks (Pwn Request, Injection). However, a critical logic error in the checkout strategy will prevent the workflow from executing correctly. Additionally, supply chain hardening is recommended for the new AI agent dependency."
decision = "REQUEST_CHANGES"

[[issues]]
severity = "critical"
file = ".github/workflows/claude-code-implement.yml"
line = 0
title = "Incorrect checkout order destroys trusted scripts"
description = "The workflow is described as checking out trusted scripts (to a subdirectory) *before* checking out the PR code (to the root). Standard `actions/checkout` behavior cleans the workspace (`clean: true`) before fetch. Consequently, the second step (checking out PR code) will delete the trusted scripts obtained in the first step. The `node` execution step will subsequently fail as the script file will be missing."
suggestion = "Reorder the steps: 1. Checkout PR code to `.`. 2. Checkout trusted scripts to `.github/trusted-scripts`. This ensures the trusted scripts are placed into the workspace after it has been prepared/cleaned."

[[issues]]
severity = "important"
file = ".github/workflows/claude-code-implement.yml"
line = 0
title = "Unpinned supply chain dependency"
description = "The workflow appears to install/run `@anthropic-ai/claude-code` dynamically (likely via `npx` or a script-based `npm install`). As this dependency is not in `package.json`/lockfiles, the workflow will always fetch the latest version. This creates a risk where a malicious or broken upstream update breaks the CI or compromises the build environment."
suggestion = "Explicitly pin the version of `@anthropic-ai/claude-code` in the workflow run command (e.g., `npx @anthropic-ai/claude-code@1.2.3`)."

[[issues]]
severity = "suggestion"
file = ".github/workflows/claude-code-implement.yml"
line = 0
title = "Missing concurrency group"
description = "The workflow triggers on `issue_comment`. Rapid successive comments could trigger multiple concurrent runs, potentially leading to git push conflicts or confused agent state."
suggestion = "Add a `concurrency` group to the workflow, e.g., `group: ${{ github.workflow }}-${{ github.event.issue.number }}`."
```