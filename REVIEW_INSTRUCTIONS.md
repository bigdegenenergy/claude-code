# ⚠️ REVIEW INSTRUCTIONS

> Generated by Gemini

```json
{
  "review": {
    "summary": "This PR introduces significant security hardening by implementing strict input allowlists and securing git operations against injection attacks. The switch from a denylist to an allowlist in the workflow and the addition of `validate_source_tag` in the install script are excellent moves. However, the strict regex patterns need verification to ensuring they don't inadvertently break valid use cases like feature branches or standard URLs.",
    "decision": "APPROVE"
  },
  "issues": [
    {
      "id": 1,
      "severity": "important",
      "file": "install.sh",
      "line": 0,
      "title": "Verify branch name regex supports forward slashes",
      "description": "The description mentions validating `SOURCE_TAG` against a \"safe pattern\" (e.g., alphanumeric, dot, underscore, hyphen). If the regex strictly follows `^[a-zA-Z0-9._-]+$`, it will block valid branch names containing forward slashes (e.g., `feature/security-fix`, `dependabot/npm/...`).",
      "suggestion": "Ensure the regex in `validate_source_tag` includes `/` (e.g., `^[a-zA-Z0-9._/-]+$`) to support hierarchical branch names, while continuing to block leading hyphens."
    },
    {
      "id": 2,
      "severity": "suggestion",
      "file": ".github/workflows/onefilellm.yml",
      "line": 0,
      "title": "Usability impact of blocking ampersand in URLs",
      "description": "The allowlist regex excludes `&`, requiring users to URL-encode it as `%26`. While this prevents background execution attacks in shell contexts, it breaks copy-pasting of standard URLs with multiple query parameters (e.g., `?foo=bar&baz=qux`).",
      "suggestion": "Confirm this trade-off is acceptable. If `INPUT_SOURCES` is always quoted in usage (e.g., `\"$INPUT_SOURCES\"`), `&` might be safe to allow. If unquoted usage is possible, the current block is correct for security."
    },
    {
      "id": 3,
      "severity": "suggestion",
      "file": "install.sh",
      "line": 0,
      "title": "Ensure git checkout uses argument separator",
      "description": "The description mentions adding the `--` separator to git checkout. It is best practice to ensure this is applied in all checkout paths within `clone_repo` to strictly separate the ref from paths.",
      "suggestion": "Verify `git checkout -- \"$SOURCE_TAG\"` is used instead of `git checkout \"$SOURCE_TAG\"`."
    }
  ]
}
```