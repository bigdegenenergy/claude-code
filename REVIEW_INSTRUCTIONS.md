# ⚠️ REVIEW INSTRUCTIONS

> **DELETE THIS FILE** after reading and addressing the issues.
> This file was generated by the Review Agent (Gemini).

## Workflow

1. Read the issues below
2. Fix the code
3. **DELETE this file** (`git rm REVIEW_INSTRUCTIONS.md`)
4. Commit with `Agent-Note:` trailer explaining your fixes

## Example Commit

```
fix: address review feedback

Agent-Note: Fixed SQL injection in auth.ts by using parameterized queries.
```

---

## Issues to Address

```toml
[review]
summary = "The refactor to a git-native agent workflow is promising, but the current implementation breaks CI for external contributors (forks) and accidentally commits ephemeral instruction files to the codebase."
decision = "REQUEST_CHANGES"

[[issues]]
severity = "critical"
file = ".github/workflows/gemini-pr-review-plus.yml"
title = "Workflow will fail on forks due to write permissions"
description = "You have escalated permissions to `contents: write` to allow the workflow to push `REVIEW_INSTRUCTIONS.md`. GitHub Actions does not grant write tokens to PRs originating from forks. This step will fail for any external contributor."
suggestion = "Wrap the push step in a condition: `if: github.event.pull_request.head.repo.full_name == github.repository`. Alternatively, use a distinct workflow for the response cycle that does not block the main PR checks."

[[issues]]
severity = "important"
file = "REVIEW_INSTRUCTIONS.md"
title = "Ephemeral agent instructions committed to PR"
description = "`REVIEW_INSTRUCTIONS.md` is intended to be a temporary communication file (as per CLAUDE.md changes). It is currently included in the PR diff. Merging this will pollute `main` with outdated instructions."
suggestion = "Remove this file from the PR. Add `REVIEW_INSTRUCTIONS.md` to `.gitignore` to prevent future accidental commits."

[[issues]]
severity = "important"
file = ".github/workflows/gemini-pr-review-plus.yml"
title = "Infinite loop risk in git-native workflow"
description = "The workflow pushes commits back to the PR branch. While the commit message trailer `[skip ci]` is standard, ensure the `Push Instructions` step explicitly uses it in the commit message. If missing, the push will trigger the workflow again, creating an infinite billing/execution loop."

[[issues]]
severity = "suggestion"
file = ".github/workflows/gemini-pr-review-plus.yml"
title = "Verify Telegram environment variable mapping"
description = "The agent note mentions adding `DECISION` and `JOB_STATUS` to the Telegram step. Ensure these are explicitly mapped in the `env:` block of that specific step, otherwise the script will reference undefined variables."
```
