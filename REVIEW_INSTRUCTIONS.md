# ⚠️ REVIEW INSTRUCTIONS

> Generated by Gemini

```json
{
  "review": {
    "summary": "The PR introduces significant usability and stability risks. The shift to natural language triggers (e.g., 'yes', 'ok', 'lgtm') in the implementation workflow is too aggressive and will lead to unintended bot executions during standard code review conversations. The new JSON parsing logic in the review workflow relies on a greedy regex that is fragile and likely to fail on complex or chatty LLM outputs. Additionally, `REVIEW_INSTRUCTIONS.md` appears to be an accidentally committed vulnerability report rather than actual instructions.",
    "decision": "REQUEST_CHANGES"
  },
  "issues": [
    {
      "id": 1,
      "severity": "important",
      "file": ".github/workflows/claude-code-implement.yml",
      "line": 0,
      "title": "Overly aggressive workflow triggers",
      "description": "The workflow is configured to trigger on common conversational words like `accept`, `yes`, `okay`, and `lgtm`. This creates a high risk of false positives where the bot attempts to implement changes based on standard approval comments or discussion, rather than explicit commands. 'LGTM' specifically is a standard approval signal, not a request for code modification.",
      "suggestion": "Revert to explicit slash commands (e.g., `/implement`) or enforce a stricter syntax (e.g., `@bot implement`) to distinguish between human conversation and bot instructions."
    },
    {
      "id": 2,
      "severity": "important",
      "file": ".github/workflows/gemini-pr-review-plus.yml",
      "line": 0,
      "title": "Fragile JSON parsing logic",
      "description": "The regex `r\"(\\{.*\\})\"` with `re.DOTALL` is greedy and assumes the LLM output contains exactly one JSON block starting with `{` and ending with `}`. If the LLM output contains explanatory text after the JSON, or multiple JSON objects (e.g. nested examples), this regex will capture too much content, causing `json.loads` to fail with a `JSONDecodeError`.",
      "suggestion": "Improve robustness by extracting content specifically from markdown code blocks (```json ... ```) or by using a non-greedy matcher combined with logic to identify the correct JSON payload."
    },
    {
      "id": 3,
      "severity": "suggestion",
      "file": "REVIEW_INSTRUCTIONS.md",
      "line": 0,
      "title": "Vulnerability report committed as instructions",
      "description": "The file `REVIEW_INSTRUCTIONS.md` appears to contain a specific code review output (listing SQLi and credential vulnerabilities) rather than generic instructions for the agent. Committing a report of existing unpatched vulnerabilities is a security risk and likely unintended.",
      "suggestion": "Remove this file or replace it with the actual prompts/instructions intended for the agent. If this was meant as a few-shot example, obscure the sensitive data and clearly label it as a template."
    }
  ]
}
```