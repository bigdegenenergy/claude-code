# ⚠️ REVIEW INSTRUCTIONS

> Generated by Gemini

```toml
[review]
summary = "This PR introduces a new Python utility script (`user_utils.py`) that contains multiple critical security vulnerabilities. Specifically, it uses raw string interpolation for SQL queries (SQL Injection), hardcodes database credentials, and uses MD5 for password hashing. These are severe blockers that make the code unsafe for use. I strongly recommend rewriting the database interaction layer to use parameterized queries, environment variables for secrets, and secure password hashing algorithms."
decision = "REQUEST_CHANGES"

[[issues]]
severity = "critical"
file = ".claude/scripts/user_utils.py"
line = 1
title = "Critical SQL Injection Vulnerability"
description = "The code uses f-strings to construct SQL queries (e.g., `f\"SELECT * FROM users WHERE username = '{username}'\"`). This allows an attacker to manipulate the query structure via input variables, leading to unauthorized data access or modification."
suggestion = "Use parameterized queries provided by your database driver. For example, change `cursor.execute(f\"...\")` to `cursor.execute(\"SELECT * FROM users WHERE username = ?\", (username,))`."

[[issues]]
severity = "critical"
file = ".claude/scripts/user_utils.py"
line = 1
title = "Hardcoded Database Credentials"
description = "The database password (`DB_PASSWORD = \"admin123\"`) is hardcoded in the source file. Committing secrets to version control is a major security risk."
suggestion = "Remove the hardcoded password. Load credentials from environment variables (e.g., using `os.getenv('DB_PASSWORD')`) or a secure secrets manager."

[[issues]]
severity = "critical"
file = ".claude/scripts/user_utils.py"
line = 1
title = "Insecure Password Hashing Algorithm"
description = "The code uses `hashlib.md5` for password hashing. MD5 is cryptographically broken and susceptible to collision and rainbow table attacks. It is not secure for storing passwords."
suggestion = "Use a secure password hashing library specifically designed for this purpose, such as `bcrypt` or `argon2`."

[[issues]]
severity = "important"
file = ".claude/scripts/user_utils.py"
line = 1
title = "Missing Resource Management"
description = "The summary indicates that database connections are opened without using context managers. This can lead to resource leaks if connections are not properly closed, especially when exceptions occur."
suggestion = "Use Python's `with` statement (context managers) for database connections to ensure they are automatically closed (e.g., `with connect(...) as conn:`)."
```