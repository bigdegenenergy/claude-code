# ⚠️ REVIEW INSTRUCTIONS

> Generated by Gemini

```json
{
  "review": {
    "summary": "The PR addresses security concerns by introducing shell quoting and adds safeguards for bot interactions. However, the update to `sanitize_commit_message` introduces a significant breaking change (returns quoted string), creates platform compatibility issues (POSIX only), and enforces an overly restrictive length limit.",
    "decision": "REQUEST_CHANGES"
  },
  "issues": [
    {
      "id": 1,
      "severity": "important",
      "file": ".claude/hooks/validators.py",
      "line": 56,
      "title": "Aggressive commit message truncation",
      "description": "Reducing the commit message limit from 500 to 100 characters is too restrictive. Standard commit messages often require more space, especially if they include a body or footer (e.g., 'Signed-off-by'). This will truncate legitimate messages.",
      "suggestion": "Restore the limit to 500 characters or simply apply the limit to the input before quoting, ensuring sufficient space for detailed messages."
    },
    {
      "id": 2,
      "severity": "important",
      "file": ".claude/hooks/validators.py",
      "line": 56,
      "title": "Platform-specific shell escaping",
      "description": "`shlex.quote` is designed for POSIX shells. If this toolkit is intended to run on Windows, this function will not correctly escape arguments for `cmd.exe` or PowerShell, leaving the system vulnerable to injection or causing syntax errors.",
      "suggestion": "If cross-platform support is needed, avoid manual shell construction and pass arguments as a list to `subprocess.run(..., shell=False)`. If shell execution is required, ensure this code is only invoked on POSIX systems."
    },
    {
      "id": 3,
      "severity": "important",
      "file": ".claude/hooks/validators.py",
      "line": 56,
      "title": "Breaking change in return value contract",
      "description": "The function now returns a shell-quoted string (e.g., `'message'`) rather than the raw sanitized text. If downstream consumers pass this result to a function that doesn't expect shell syntax (like `subprocess.run` with a list of args, or a Git API), the commit message will literally contain the single quotes.",
      "suggestion": "Verify all call sites of `sanitize_commit_message`. If the consumer handles argument passing securely (e.g. via list args), `shlex.quote` is unnecessary and harmful. If the consumer constructs a shell string, document that this function now returns a quoted string."
    }
  ]
}
```