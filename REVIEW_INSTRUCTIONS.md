# ‚ö†Ô∏è REVIEW INSTRUCTIONS

> Generated by Gemini

```toml
[review]
summary = "The changes to the Claude Code implementation script properly handle module resolution in the CI environment. However, there is a critical logic error in the Gemini review workflow where it resets the workspace to `main` instead of the PR branch, likely discarding the changes meant to be reviewed. Additionally, the new reaction-based trigger in the Claude workflow has UX and logic flaws regarding event triggering and actor validation."
decision = "REQUEST_CHANGES"

[[issues]]
severity = "critical"
file = ".github/workflows/gemini-pr-review-plus.yml"
line = 0
title = "Incorrect git reset target discards PR changes"
description = "The command `git reset --hard origin/main` forces the workspace to match the `main` branch. For a PR review workflow, this will discard the changes introduced in the PR (unless the PR branch happens to be `main`). This effectively reverts the workspace to the base state, preventing the agent from reviewing the actual PR code. This pattern appears in two locations (setup and cleanup)."
suggestion = "Change the reset target to the PR's head branch. Use `git fetch origin ${{ github.head_ref }}` and `git reset --hard origin/${{ github.head_ref }}`."

[[issues]]
severity = "important"
file = ".github/workflows/claude-code-implement.yml"
line = 0
title = "Reaction trigger logic is ineffective and misleading"
description = "The logic assumes the workflow runs on `issue_comment` (implied by listing comments and checking context). GitHub Actions does not trigger `issue_comment` workflows when a reaction is added. Therefore, the 'React with üëç' instruction will not trigger the workflow until someone subsequently comments. Furthermore, the check `r.user.login === context.actor` fails if the person triggering the workflow (the commenter) is different from the person who reacted (the approver)."
suggestion = "Either implement a proper `on: issue_reaction` trigger (handling the event payload correctly) or remove the reaction monitoring logic and instructions, relying instead on the reliable `/accept` slash command."

[[issues]]
severity = "suggestion"
file = ".github/scripts/claude-code-implement.cjs"
line = 0
title = "Security note on dynamic require"
description = "The script uses `require(path.join(sdkPath, ...))` where `sdkPath` is derived from an environment variable. While currently safe because `SDK_PATH` is statically defined in the workflow YAML, ensure that `SDK_PATH` never accepts untrusted user input in future iterations to prevent arbitrary code execution."
suggestion = "No immediate change needed, but maintain strict control over the `SDK_PATH` environment variable in the workflow definition."
```